<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Burcham">
<meta name="description" content="Daniel Burcham is an assistant professor at Colorado State University studying and teaching about trees">

<title>Historical low temperatures in Fort Collins, CO | Daniel Burcham</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y33GXW5WS7"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Y33GXW5WS7', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

<script src="../../../../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../../../styles.css">
<meta property="og:title" content="Historical low temperatures in Fort Collins, CO | Daniel Burcham">
<meta property="og:description" content="Use the {extRemes} R package to fit extreme value distributions to daily low temperatures">
<meta property="og:image" content="https://danielburcham.dev/blog\2023\02\10\fort-collins-low-temps\Effective-100-year-return-levels.png">
<meta property="og:site-name" content="Daniel Burcham">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Daniel Burcham</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../research/index.html">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../blog/index.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#the-dead-of-winter" id="toc-the-dead-of-winter" class="nav-link active" data-scroll-target="#the-dead-of-winter">The dead of winter</a></li>
  <li><a href="#freezing-tolerance-in-trees" id="toc-freezing-tolerance-in-trees" class="nav-link" data-scroll-target="#freezing-tolerance-in-trees">Freezing tolerance in trees</a></li>
  <li><a href="#statistics-of-extremes" id="toc-statistics-of-extremes" class="nav-link" data-scroll-target="#statistics-of-extremes">Statistics of extremes</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Historical low temperatures in Fort Collins, CO</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">r</div>
    <div class="quarto-category">tidyverse</div>
    <div class="quarto-category">ggplot</div>
    <div class="quarto-category">extreme values</div>
  </div>
  </div>

<div>
  <div class="description">
    Use the {extRemes} R package to fit extreme value distributions to daily low temperatures
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Daniel Burcham <a href="https://orcid.org/0000-0002-1793-3945" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Friday, February 10, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="the-dead-of-winter" class="level2">
<h2 class="anchored" data-anchor-id="the-dead-of-winter">The dead of winter</h2>
<p>Recently, the Colorado State University (CSU) weather station recorded a daily low temperature of -15.4° F in the early morning of 22 December 2022. At the time, wind chills varying between -50° and -35° F threatened lives across most of the Eastern plains in Colorado. The frigid temperatures accompanied a string of unpleasant winter weather for much of the US with many places experiencing bitter cold, gusty winds, and heavy snow; and the unfortunate timing of the weather only compounded the frustrations of many people traveling over the holidays.</p>
<p>Cold weather snaps are common in Colorado, and the plants and people living here must equally tolerate occasional severe freezing. Fortunately, many trees easily endure freezing temperatures during the winter months - the vegetative buds on most deciduous broadleaf trees withstand temperatures between -13° and -37° F (-25° and -35° C). Occasionally, though, some cultivated trees are injured or killed by low temperatures, especially if temperatures drop abruptly after relatively warm weather (e.g., <em>false springs</em>) or the species was introduced from a milder climate. The sudden freezes can be especially harmful if trees are not acclimated to freezing temperatures; the events can damage buds, leaves, and flowers and, in some cases, disrupt water conduction or natural growth patterns. In recent years, for example, several freeze events killed large numbers of Siberian elms (<em>Ulmus pumila</em>) along the Front Range, and I have heard similar stories about widespread tree damage caused by unusual fall freezes in earlier decades.</p>
</section>
<section id="freezing-tolerance-in-trees" class="level2">
<h2 class="anchored" data-anchor-id="freezing-tolerance-in-trees">Freezing tolerance in trees</h2>
<p>Trees use a number of strategies to tolerate freezing temperatures during winter, including withdrawing water into non-living tissues where ice formation avoids damage to living cells, lowering the freezing point of the water retained in cells, and forming physical barriers restricting the propagation of ice crystals. As temperatures fall below freezing, extracellular ice draws out some of the water retained in living cells along an osmotic gradient between the two phases of water, and trees further modify their living cells to tolerate the desiccation during freezing. In addition to leaf shedding, the modifications are all part of a tree’s yearly preparations for the winter season.</p>
<p>The seasonal pattern of cold hardiness is U-shaped with trees increasingly hardy to progressively lower freezing temperatures during the fall, consistently hardy to a minimum temperature during the winter, and decreasingly hardy during the spring. Crucially, the timing of seasonal transitions ensures that a tree’s physiological activity matches changing environmental conditions. There is broad agreement that day length and temperature mainly govern the acquisition and loss of cold hardiness, respectively, in the fall and spring each year, but individual tree species also display a unique sensitivity to the two seasonal environmental cues for spring emergence. Some species, like green ash (<em>Fraxinus pennsylvanica</em>) and Siberian elm, are more sensitive to temperature during bud burst in the spring, and others, like white ash (<em>Fraxinus americana</em>) and littleleaf linden (<em>Tilia cordata</em>), are more sensitive to day length during the same transition. The heavy reliance on fickle temperatures for seasonal transitions may explain the winter damage more commonly observed on the former two species, but the seasonal cues for many species are also moderated by a chilling (accumulated low temperature) requirement that, if unfulfilled, prevents premature bud burst.</p>
<p>For a given species, the precise timing of spring budburst is determined by the maximum cold hardiness, accumulated low winter temperatures (i.e., chilling), warm spring temperatures (i.e., forcing), and increasing spring day length (i.e., photoperiod). In many places, scientists have observed a steady advancement of biological spring towards earlier times of the year amid the warming climate, and the risk of freeze damage during false springs may be especially significant for trees, depending on the rate of cold hardiness loss during spring. In Colorado, wild temperature fluctuations are already commonplace in the spring and fall, and many people have learned to simply avoid planting trees tending to leaf out early or retain leaves late in the season. Moving forward, it will still be important to consider tree phenology when evaluating the possibility of planting new species in our landscapes.</p>
</section>
<section id="statistics-of-extremes" class="level2">
<h2 class="anchored" data-anchor-id="statistics-of-extremes">Statistics of extremes</h2>
<p>Recently, I received a summary of extreme low temperatures in Fort Collins during the 20th Century, and the report clearly showed that our predecessors on the Front Range endured <em>much</em> colder days. Curious about recent trends, I decided to update the summary with more recent observations and explore the use of extreme value analysis to characterize severe freezing events in Fort Collins using the <code>extRemes</code> package in <code>R</code>. Instead of evaluating more commonplace conditions, extreme value distributions depict the occurrence of maximum (or minimum) values in a data set. Usefully, they can characterize extreme climate processes without a mechanistic treatment of the underlying physical phenomena. They have been used to statistically describe the probability of very rare or extreme events, such as severe “100-year” floods, and they have yielded important design criteria for engineers anticipating the limits of environmental conditions affecting buildings or infrastructure. The cumulative density function (CDF) for the Generalized Extreme Value (GEV) distribution can be defined as: <span id="eq-GEVD-CDF"><span class="math display">\[F(x;\mu,\sigma,\gamma)=e^{-[1-\gamma(x-\mu)/\sigma]^{1/\gamma}} \tag{1}\]</span></span> where <span class="math inline">\(\gamma\ne0\)</span> and <span class="math inline">\([1-\gamma(x-\mu)/\sigma]&gt;0\)</span>. The three parameters <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(\gamma\)</span> depict the location, scale, and shape of the distribution. The location parameter, <span class="math inline">\(\mu\)</span>, represents the most common, i.e., modal, extreme value. The scale parameter, <span class="math inline">\(\sigma\)</span>, portrays the rate of change in <span class="math inline">\(x\)</span> with the natural logarithm of time, and the ration <span class="math inline">\(\sigma/\gamma\)</span> represents the maximum extreme value. The return level, <span class="math inline">\(x\)</span>, associated with a return period, <span class="math inline">\(T\)</span>, corresponds to the <span class="math inline">\(1-p\)</span> quantile of the distribution, where <span class="math inline">\(p=1/T\)</span>. For example, a 100-year return level would correspond to the <span class="math inline">\(1-{1\over100}=0.99\)</span> quantile. Return levels can be obtained using the quantile function: <span id="eq-quantile-function"><span class="math display">\[F^{-1}(1-p;\mu,\sigma,\gamma)=\mu+(\sigma/\gamma)\{{1\over[-ln(1-p)]^\gamma}-1\} \tag{2}\]</span></span> where <span class="math inline">\(\gamma\ne0\)</span>. The interpretation of a return level often causes confusion, but it is simply the value expected to be exceeded, on average, once every <span class="math inline">\(T\)</span> years.</p>
<p>To update the data, I consolidated the 20<sup>th</sup> Century weather data from Fort Collins contained in <code>extRemes</code> with more recent observations from the same weather station. Currently, the weather station is situated on the main campus of CSU near the Lory Student Center. The station was originally located near the former “Old Main” building with observations starting on 1 January 1889.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extRemes)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Load FCwx data from extRemes package</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FCwx)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Query updated FCwx observations and combine</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>api <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"http://www.coagmet.colostate.edu/data/daily/fcl01.json?from=2000-01-01&amp;to=2022-12-31&amp;fields=tMax,tMin,precip"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>FCwx2k <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind.data.frame,<span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(api<span class="sc">$</span>content))) <span class="sc">|&gt;</span> </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(time,<span class="st">"%Y-%m-%d"</span>), <span class="at">Dy =</span> <span class="fu">yday</span>(dt), <span class="at">Mn =</span> <span class="fu">month</span>(dt), <span class="at">Year =</span> <span class="fu">year</span>(dt)) <span class="sc">|&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt,Dy,Mn,Year,tMin) <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">MnT =</span> tMin)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> FCwx <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Dy,<span class="st">"-"</span>,Mn,<span class="st">"-"</span>,Year),<span class="st">"%d - %m - %Y"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt,Dy,Mn,Year,MnT)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(FCwx,FCwx2k) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">doy =</span> <span class="fu">yday</span>(dt))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> FCwx[FCwx<span class="sc">$</span>MnT <span class="sc">!=</span> <span class="sc">-</span><span class="dv">999</span>,]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="at">Inter =</span> <span class="fu">windowsFont</span>(<span class="st">"Inter"</span>))</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>theme_nice <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Inter"</span>) <span class="sc">+</span> </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">"points"</span>),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span> <span class="st">"Inter"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Inter"</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Inter"</span>, <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(<span class="st">"label"</span>, <span class="fu">list</span>(<span class="at">family=</span><span class="st">"Inter"</span>))</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(ggtext<span class="sc">::</span>GeomRichText, <span class="fu">list</span>(<span class="at">family=</span><span class="st">"Inter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Between 1900 and 2022, there were 19,632 days with low temperatures below freezing in Fort Collins (approximately 44% of all observed days). Recorded on 01 February 1951, the coldest daily low was -41° F! Wow, that’s really cold. Near the lower limit of the observed range, there were 73 days with low temperatures below -20° F, but such extremely cold days were not observed uniformly over the past 122 years: 79.5% of the events occurred before 1950.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FCwx,<span class="fu">aes</span>(<span class="at">x=</span>dt,<span class="at">y=</span>MnT)) <span class="sc">+</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">position=</span><span class="st">"jitter"</span>) <span class="sc">+</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Daily Minimum Temperature"</span>) <span class="sc">+</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-global-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-global-plot-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Daily minimum temperatures in Fort Collins, CO between 1900 and 2022</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In the entire data record (<a href="#fig-global-plot">Figure&nbsp;1</a>), there is an obvious upward trend in the daily minimum temperatures over time, and you can also clearly see more variability in the lower limit of observations. As a convenient starting point, I simply fit a GEV distribution to all observations. The location parameter for the preliminary fit, for example, indicated that the most common daily minimum temperature was 41.6° F (<a href="#tbl-fit0">Table&nbsp;1</a>). For such cases, one important modeling assumption requires the use of homogeneous data obtained from a process <em>not</em> undergoing any systematic change. In many cases, however, extreme value processes exhibit slowly-varying or cyclical behavior, and the probability of an extreme event, often, varies according to diurnal, seasonal, or annual conditions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit stationary model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Stationary model summary table</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>fit0.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit0, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>params.ci.fit0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit0, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit0) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>fit0.model.summary <span class="ot">&lt;-</span> params.ci.fit0 <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>fit0.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"Location, &amp;#956;"</span>,<span class="st">"Scale, &amp;#963;"</span>,<span class="st">"Shape, &amp;#947;"</span>), fit0.model.summary)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit0.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position=</span><span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit0<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit0.summary<span class="sc">$</span>BIC,<span class="dv">2</span>), <span class="at">sep=</span><span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-fit0" class="anchored">

<table class="table" style="width: auto !important; border-bottom: 0;"><caption>Table&nbsp;1:  Parameter estimates for stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022 </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Parameters </th>
   <th style="text-align:center;"> Estimate (95% CI) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;width: 10em; "> Location, μ </td>
   <td style="text-align:center;width: 12em; "> -41.64 (-41.8, -41.48) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; "> Scale, σ </td>
   <td style="text-align:center;width: 12em; "> 15.26 (15.15, 15.38) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; "> Shape, γ </td>
   <td style="text-align:center;width: 12em; "> -0.14 (-0.14, -0.13) </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Negative log-likelihood (NLLH): 189790.29; Bayesian Information Criterion (BIC): 379612.71</td></tr></tfoot>
</table>

</div>
</div>
</div>
<p>Fortunately, it is possible to account for non-stationary extremes by directly modeling variation in the distribution parameters. To explore variation in the distribution parameters over time, I fit multiple stationary GEV distributions to short, overlapping five-year segments of the data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit GEVD using running five-year windows between 1902 and 2018 and store result</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mnt.yrs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1902</span><span class="sc">:</span><span class="dv">2018</span>){</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  mnt.yrs[[i<span class="dv">-1901</span>]] <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">format</span>(dt,<span class="st">"%Y"</span>) <span class="sc">==</span> <span class="fu">seq</span>(i<span class="dv">-2</span>,i<span class="sc">+</span><span class="dv">2</span>)), <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>locs.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">locations =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">1</span>)))))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>scls.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">scales =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>)))))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>shps.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">shapes =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">3</span>)))))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>locs.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>locations)) <span class="sc">+</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Location, \u03bc"</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.64</span>) <span class="sc">+</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.8</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.48</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>scls.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>scales)) <span class="sc">+</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Scale, \u03c3"</span>) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.26</span>) <span class="sc">+</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.15</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.38</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shps.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>shapes)) <span class="sc">+</span> </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Shape, \u03b3"</span>) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.136</span>) <span class="sc">+</span> </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.143</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.129</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,p3,<span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-moving-fit" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-moving-fit-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Generalized Extreme Value distribution parameters fit to running five-year windows of daily minimum temperature in Fort Collins, CO between 1902 and 2018</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The estimates show obvious variation in the location parameter over the examined years with the modal (negative) daily low slowly decreasing (increasing) over time. This is consistent with the increasing trend in daily minimum temperatures observed in <a href="#fig-global-plot">Figure&nbsp;1</a>. Compared to the location parameter, the other two parameters do not similarly vary over time. However, it’s intuitively reasonable to expect seasonal variation in daily minimum temperatures, and a simply harmonic function can be used to model cyclical variation in seasonal lows. For the non-stationary case, I fit two candidate models: one modeling annual and seasonal variation in the location parameter and a second modeling additional seasonal variation in the scale parameter. In both models, the location parameter was modeled using: <span id="eq-fit-1"><span class="math display">\[\mu=\mu_0+\mu_1cos(2\pi*doy/365.25)+\mu_2sin(2\pi*doy/365.25)+\mu_3*year \tag{3}\]</span></span> where <span class="math inline">\(doy\)</span> is the day of the year represented as an integer and <span class="math inline">\(year\)</span> is the calendar year.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx,<span class="at">location.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> Year, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1 summary table</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>fit1.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit1, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>params.ci.fit1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit1, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fit1.model.summary <span class="ot">&lt;-</span> params.ci.fit1 <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fit1.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"&amp;#956;0"</span>, <span class="st">"&amp;#956;1"</span>, <span class="st">"&amp;#956;2"</span>, <span class="st">"&amp;#956;3"</span>, <span class="st">"Scale, &amp;#963;"</span>,<span class="st">"Shape, &amp;#947;"</span>), fit1.model.summary)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit1.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Location, &amp;#956;"</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit1<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit1.summary<span class="sc">$</span>BIC,<span class="dv">2</span>),<span class="st">"; See Equation 3 for the function used to model the location  parameter."</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-fit1" class="anchored">

<table class="table" style="width: auto !important; border-bottom: 0;"><caption>Table&nbsp;2:  Parameter estimates for non-stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022 </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Parameters </th>
   <th style="text-align:center;"> Estimate (95% CI) </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="2" style="border-bottom: 1px solid;"><strong>Location, μ</strong></td></tr>
<tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ0 </td>
   <td style="text-align:center;width: 12em; "> 50.11 (44.87, 55.35) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ1 </td>
   <td style="text-align:center;width: 12em; "> 18.38 (18.28, 18.49) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ2 </td>
   <td style="text-align:center;width: 12em; "> 5.37 (5.28, 5.47) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ3 </td>
   <td style="text-align:center;width: 12em; "> -0.04 (-0.05, -0.04) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; "> Scale, σ </td>
   <td style="text-align:center;width: 12em; "> 7.17 (7.11, 7.23) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; "> Shape, γ </td>
   <td style="text-align:center;width: 12em; "> -0.1 (-0.1, -0.09) </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Negative log-likelihood (NLLH): 155733.78; Bayesian Information Criterion (BIC): 311531.82; See Equation 3 for the function used to model the location  parameter.</td></tr></tfoot>
</table>

</div>
</div>
</div>
<p>Compared to the stationary model, the BIC is about 18% lower for the non-stationary mode, indicating a much better fit when the annual and seasonal variation in the location parameter was modeled. In the second model, the scale parameter was additionally modeled using: <span id="eq-fit-2"><span class="math display">\[\sigma=\sigma_0+\sigma_1cos(2\pi*doy/365.25)+\sigma_2sin(2\pi*doy/365.25) \tag{4}\]</span></span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx,<span class="at">location.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> Year, <span class="at">scale.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>), <span class="at">use.phi =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1 summary table</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fit2.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit2, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>params.ci.fit2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>fit2.model.summary <span class="ot">&lt;-</span> params.ci.fit2 <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>fit2.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"&amp;#956;0"</span>, <span class="st">"&amp;#956;1"</span>, <span class="st">"&amp;#956;2"</span>, <span class="st">"&amp;#956;3"</span>, <span class="st">"&amp;#963;0"</span>, <span class="st">"&amp;#963;1"</span>, <span class="st">"&amp;#963;2"</span>, <span class="st">"Shape, &amp;#947;"</span>), fit2.model.summary)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit2.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Location, &amp;#956;"</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Scale, &amp;#963;"</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit2<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit2.summary<span class="sc">$</span>BIC,<span class="dv">2</span>),<span class="st">"; See Equation 3 and Equation 4 for the functions used to model the location and scale parameter, respectively."</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-fit2" class="anchored">

<table class="table" style="width: auto !important; border-bottom: 0;"><caption>Table&nbsp;3:  Parameter estimates for non-stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022 </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Parameters </th>
   <th style="text-align:center;"> Estimate (95% CI) </th>
  </tr>
 </thead>
<tbody>
  <tr grouplength="4"><td colspan="2" style="border-bottom: 1px solid;"><strong>Location, μ</strong></td></tr>
<tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ0 </td>
   <td style="text-align:center;width: 12em; "> 53.59 (53.52, 53.66) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ1 </td>
   <td style="text-align:center;width: 12em; "> 19.21 (19.12, 19.31) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ2 </td>
   <td style="text-align:center;width: 12em; "> 6.32 (6.24, 6.41) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> μ3 </td>
   <td style="text-align:center;width: 12em; "> -0.05 (-0.05, -0.05) </td>
  </tr>
  <tr grouplength="3"><td colspan="2" style="border-bottom: 1px solid;"><strong>Scale, σ</strong></td></tr>
<tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> σ0 </td>
   <td style="text-align:center;width: 12em; "> 1.89 (1.89, 1.9) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> σ1 </td>
   <td style="text-align:center;width: 12em; "> 0.42 (0.41, 0.43) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; padding-left: 2em;" indentlevel="1"> σ2 </td>
   <td style="text-align:center;width: 12em; "> 0.14 (0.13, 0.15) </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 10em; "> Shape, γ </td>
   <td style="text-align:center;width: 12em; "> -0.14 (-0.14, -0.13) </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span> <sup></sup> Negative log-likelihood (NLLH): 151553.63; Bayesian Information Criterion (BIC): 303192.96; See Equation 3 and Equation 4 for the functions used to model the location and scale parameter, respectively.</td></tr></tfoot>
</table>

</div>
</div>
</div>
<p>The fit statistics and model diagnostics (not shown) generally suggest that the second model is a better choice between the two non-stationary candidate models. Although it could undoubtedly be improved, I want to explore some applications. With the fit model, you can calculate several things</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1900</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1900 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v1),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1900) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1940</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1940 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v2),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1940) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1980</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1980 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v3),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1980) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2000</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr2000 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v4),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr2000) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>v5 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2020</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr2020 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v5),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>v6 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1900</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1900 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v6),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1900) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>v7 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1940</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1940 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v7),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1940) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>v8 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1980</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1980 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v8),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1980) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>v9 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2000</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov2000 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v9),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov2000) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>v10 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2020</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov2020 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v10),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>ciRLevels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ci100YrRLevelsMarApr1900,ci100YrRLevelsMarApr1940,ci100YrRLevelsMarApr1980,ci100YrRLevelsMarApr2000,ci100YrRLevelsMarApr2020,ci100YrRLevelsOctNov1900,ci100YrRLevelsOctNov1940,ci100YrRLevelsOctNov1980,ci100YrRLevelsOctNov2000,ci100YrRLevelsOctNov2020) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">rep</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1900</span>,<span class="dv">1940</span>,<span class="dv">1980</span>,<span class="dv">2000</span>,<span class="dv">2020</span>)),<span class="at">each=</span><span class="dv">61</span>,<span class="at">times=</span><span class="dv">2</span>), <span class="at">dt =</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">dt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1900/03/01"</span>),<span class="fu">as.Date</span>(<span class="st">"1900/04/30"</span>),<span class="at">by=</span><span class="st">"days"</span>),<span class="dv">5</span>)),<span class="fu">data.frame</span>(<span class="at">dt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1900/10/01"</span>),<span class="fu">as.Date</span>(<span class="st">"1900/11/30"</span>),<span class="at">by=</span><span class="st">"days"</span>),<span class="dv">5</span>))), <span class="at">Season =</span> <span class="fu">rep</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Spring"</span>,<span class="st">"Fall"</span>)),<span class="at">each=</span><span class="dv">305</span>))</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>ciRLevels[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> ciRLevels[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ciRLevels, <span class="fu">aes</span>(<span class="at">x =</span> dt<span class="sc">$</span>dt, <span class="at">y =</span> est)) <span class="sc">+</span> </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Year), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ll,<span class="at">ymax=</span>ul,<span class="at">fill=</span>Year),<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"100-year daily low"</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span><span class="fu">factor</span>(Season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Spring"</span>,<span class="st">"Fall"</span>)), <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-return-levels" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-return-levels-1.png" class="img-fluid figure-img" style="width:85.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Effective 100-year return levels for daily minimum temperatures in Fort Collins, CO on different dates</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Just last year, we had a 15° F daily low on 15 April 2021 - a 100-year freeze!</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb8" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Historical low temperatures in Fort Collins, CO"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-02-10</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Daniel Burcham</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0002-1793-3945</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Use the {extRemes} R package to fit extreme value distributions to daily low temperatures"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> Effective-100-year-return-levels.png</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - r</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyverse</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - ggplot</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - extreme values</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the settings</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.width =</span> <span class="dv">6</span>, <span class="at">fig.align =</span> <span class="st">"center"</span>, </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.retina =</span> <span class="dv">3</span>, <span class="at">out.width =</span> <span class="st">"85%"</span>, </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                      <span class="at">collapse =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## The dead of winter</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>Recently, the Colorado State University (CSU) weather station recorded a daily low temperature of -15.4<span class="dv">&amp;deg;</span> F in the early morning of 22 December 2022. At the time, wind chills varying between -50<span class="dv">&amp;deg;</span> and -35<span class="dv">&amp;deg;</span> F threatened lives across most of the Eastern plains in Colorado. The frigid temperatures accompanied a string of unpleasant winter weather for much of the US with many places experiencing bitter cold, gusty winds, and heavy snow; and the unfortunate timing of the weather only compounded the frustrations of many people traveling over the holidays. </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>Cold weather snaps are common in Colorado, and the plants and people living here must equally tolerate occasional severe freezing. Fortunately, many trees easily endure freezing temperatures during the winter months - the vegetative buds on most deciduous broadleaf trees withstand temperatures between -13<span class="dv">&amp;deg;</span> and -37<span class="dv">&amp;deg;</span> F (-25<span class="dv">&amp;deg;</span> and -35<span class="dv">&amp;deg;</span> C). Occasionally, though, some cultivated trees are injured or killed by low temperatures, especially if temperatures drop abruptly after relatively warm weather (e.g., *false springs*) or the species was introduced from a milder climate. The sudden freezes can be especially harmful if trees are not acclimated to freezing temperatures; the events can damage buds, leaves, and flowers and, in some cases, disrupt water conduction or natural growth patterns. In recent years, for example, several freeze events killed large numbers of Siberian elms (*Ulmus pumila*) along the Front Range, and I have heard similar stories about widespread tree damage caused by unusual fall freezes in earlier decades. </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Freezing tolerance in trees</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>Trees use a number of strategies to tolerate freezing temperatures during winter, including withdrawing water into non-living tissues where ice formation avoids damage to living cells, lowering the freezing point of the water retained in cells, and forming physical barriers restricting the propagation of ice crystals. As temperatures fall below freezing, extracellular ice draws out some of the water retained in living cells along an osmotic gradient between the two phases of water, and trees further modify their living cells to tolerate the desiccation during freezing. In addition to leaf shedding, the modifications are all part of a tree's yearly preparations for the winter season.</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>The seasonal pattern of cold hardiness is U-shaped with trees increasingly hardy to progressively lower freezing temperatures during the fall, consistently hardy to a minimum temperature during the winter, and decreasingly hardy during the spring. Crucially, the timing of seasonal transitions ensures that a tree's physiological activity matches changing environmental conditions. There is broad agreement that day length and temperature mainly govern the acquisition and loss of cold hardiness, respectively, in the fall and spring each year, but individual tree species also display a unique sensitivity to the two seasonal environmental cues for spring emergence. Some species, like green ash (*Fraxinus pennsylvanica*) and Siberian elm, are more sensitive to temperature during bud burst in the spring, and others, like white ash (*Fraxinus americana*) and littleleaf linden (*Tilia cordata*), are more sensitive to day length during the same transition. The heavy reliance on fickle temperatures for seasonal transitions may explain the winter damage more commonly observed on the former two species, but the seasonal cues for many species are also moderated by a chilling (accumulated low temperature) requirement that, if unfulfilled, prevents premature bud burst.</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>For a given species, the precise timing of spring budburst is determined by the maximum cold hardiness, accumulated low winter temperatures (i.e., chilling), warm spring temperatures (i.e., forcing), and increasing spring day length (i.e., photoperiod). In many places, scientists have observed a steady advancement of biological spring towards earlier times of the year amid the warming climate, and the risk of freeze damage during false springs may be especially significant for trees, depending on the rate of cold hardiness loss during spring. In Colorado, wild temperature fluctuations are already commonplace in the spring and fall, and many people have learned to simply avoid planting trees tending to leaf out early or retain leaves late in the season. Moving forward, it will still be important to consider tree phenology when evaluating the possibility of planting new species in our landscapes. </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Statistics of extremes</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>Recently, I received a summary of extreme low temperatures in Fort Collins during the 20th Century, and the report clearly showed that our predecessors on the Front Range endured *much* colder days. Curious about recent trends, I decided to update the summary with more recent observations and explore the use of extreme value analysis to characterize severe freezing events in Fort Collins using the <span class="in">`extRemes`</span> package in <span class="in">`R`</span>. Instead of evaluating more commonplace conditions, extreme value distributions depict the occurrence of maximum (or minimum) values in a data set. Usefully, they can characterize extreme climate processes without a mechanistic treatment of the underlying physical phenomena. They have been used to statistically describe the probability of very rare or extreme events, such as severe "100-year" floods, and they have yielded important design criteria for engineers anticipating the limits of environmental conditions affecting buildings or infrastructure. The cumulative density function (CDF) for the Generalized Extreme Value (GEV) distribution can be defined as: $$F(x;\mu,\sigma,\gamma)=e^{-<span class="co">[</span><span class="ot">1-\gamma(x-\mu)/\sigma</span><span class="co">]</span>^{1/\gamma}}$${#eq-GEVD-CDF} where $\gamma\ne0$ and $<span class="co">[</span><span class="ot">1-\gamma(x-\mu)/\sigma</span><span class="co">]</span>&gt;0$. The three parameters $\mu$, $\sigma$, and $\gamma$ depict the location, scale, and shape of the distribution. The location parameter, $\mu$, represents the most common, i.e., modal, extreme value. The scale parameter, $\sigma$, portrays the rate of change in $x$ with the natural logarithm of time, and the ration $\sigma/\gamma$ represents the maximum extreme value. The return level, $x$, associated with a return period, $T$, corresponds to the $1-p$ quantile of the distribution, where $p=1/T$. For example, a 100-year return level would correspond to the $1-{1\over100}=0.99$ quantile. Return levels can be obtained using the quantile function: $$F^{-1}(1-p;\mu,\sigma,\gamma)=\mu+(\sigma/\gamma)<span class="sc">\{</span>{1\over<span class="co">[</span><span class="ot">-ln(1-p)</span><span class="co">]</span>^\gamma}-1<span class="sc">\}</span>$${#eq-quantile-function} where $\gamma\ne0$. The interpretation of a return level often causes confusion, but it is simply the value expected to be exceeded, on average, once every $T$ years.</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>To update the data, I consolidated the 20^th^ Century weather data from Fort Collins contained in <span class="in">`extRemes`</span> with more recent observations from the same weather station. Currently, the weather station is situated on the main campus of CSU near the Lory Student Center. The station was originally located near the former "Old Main" building with observations starting on 1 January 1889. </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries-data-graphics, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extRemes)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Load FCwx data from extRemes package</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(FCwx)</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Query updated FCwx observations and combine</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>api <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"http://www.coagmet.colostate.edu/data/daily/fcl01.json?from=2000-01-01&amp;to=2022-12-31&amp;fields=tMax,tMin,precip"</span>)</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>FCwx2k <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind.data.frame,<span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(api<span class="sc">$</span>content))) <span class="sc">|&gt;</span> </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(time,<span class="st">"%Y-%m-%d"</span>), <span class="at">Dy =</span> <span class="fu">yday</span>(dt), <span class="at">Mn =</span> <span class="fu">month</span>(dt), <span class="at">Year =</span> <span class="fu">year</span>(dt)) <span class="sc">|&gt;</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt,Dy,Mn,Year,tMin) <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">MnT =</span> tMin)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> FCwx <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dt =</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(Dy,<span class="st">"-"</span>,Mn,<span class="st">"-"</span>,Year),<span class="st">"%d - %m - %Y"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dt,Dy,Mn,Year,MnT)</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(FCwx,FCwx2k) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">doy =</span> <span class="fu">yday</span>(dt))</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>FCwx <span class="ot">&lt;-</span> FCwx[FCwx<span class="sc">$</span>MnT <span class="sc">!=</span> <span class="sc">-</span><span class="dv">999</span>,]</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="at">Inter =</span> <span class="fu">windowsFont</span>(<span class="st">"Inter"</span>))</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>theme_nice <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Inter"</span>) <span class="sc">+</span> </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">"points"</span>),</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family=</span> <span class="st">"Inter"</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Inter"</span>),</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Inter"</span>, <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">1</span>), <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">color =</span> <span class="cn">NA</span>))</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(<span class="st">"label"</span>, <span class="fu">list</span>(<span class="at">family=</span><span class="st">"Inter"</span>))</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="fu">update_geom_defaults</span>(ggtext<span class="sc">::</span>GeomRichText, <span class="fu">list</span>(<span class="at">family=</span><span class="st">"Inter"</span>))</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>Between <span class="in">`r min(format(FCwx$dt,"%Y"))`</span> and <span class="in">`r max(format(FCwx$dt,"%Y"))`</span>, there were <span class="in">`r format(sum(FCwx$MnT &lt; 32, na.rm = TRUE),big.mark=",")`</span> days with low temperatures below freezing in Fort Collins (approximately 44% of all observed days). Recorded on <span class="in">`r format(FCwx[FCwx$MnT == min(FCwx$MnT),1], "%d %B %Y")`</span>, the coldest daily low was <span class="in">`r min(FCwx$MnT)`</span><span class="dv">&amp;deg;</span> F! Wow, that's really cold. Near the lower limit of the observed range, there were <span class="in">`r sum(FCwx$MnT &lt; -20, na.rm = TRUE)`</span> days with low temperatures below -20<span class="dv">&amp;deg;</span> F, but such extremely cold days were not observed uniformly over the past 122 years: <span class="in">`r round((nrow(FCwx |&gt; filter(MnT &lt; -20 &amp; format(dt,"%Y") &lt; 1950)) / sum(FCwx$MnT &lt; -20, na.rm = TRUE)),3)*100`</span>% of the events occurred before 1950.</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r global-plot, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-global-plot</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Daily minimum temperatures in Fort Collins, CO between 1900 and 2022"</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FCwx,<span class="fu">aes</span>(<span class="at">x=</span>dt,<span class="at">y=</span>MnT)) <span class="sc">+</span> </span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">position=</span><span class="st">"jitter"</span>) <span class="sc">+</span> </span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span> </span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Daily Minimum Temperature"</span>) <span class="sc">+</span> </span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>()</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>In the entire data record (@fig-global-plot), there is an obvious upward trend in the daily minimum temperatures over time, and you can also clearly see more variability in the lower limit of observations. As a convenient starting point, I simply fit a GEV distribution to all observations. The location parameter for the preliminary fit, for example, indicated that the most common daily minimum temperature was 41.6<span class="dv">&amp;deg;</span> F (@tbl-fit0). For such cases, one important modeling assumption requires the use of homogeneous data obtained from a process *not* undergoing any systematic change. In many cases, however, extreme value processes exhibit slowly-varying or cyclical behavior, and the probability of an extreme event, often, varies according to diurnal, seasonal, or annual conditions. </span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r initial-fit, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fit0</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Parameter estimates for stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022"</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit stationary model</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Stationary model summary table</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>fit0.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit0, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>params.ci.fit0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit0, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit0) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>fit0.model.summary <span class="ot">&lt;-</span> params.ci.fit0 <span class="sc">|&gt;</span> </span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit0<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>fit0.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"Location, &amp;#956;"</span>,<span class="st">"Scale, &amp;#963;"</span>,<span class="st">"Shape, &amp;#947;"</span>), fit0.model.summary)</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit0.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position=</span><span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit0<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit0.summary<span class="sc">$</span>BIC,<span class="dv">2</span>), <span class="at">sep=</span><span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>Fortunately, it is possible to account for non-stationary extremes by directly modeling variation in the distribution parameters. To explore variation in the distribution parameters over time, I fit multiple stationary GEV distributions to short, overlapping five-year segments of the data. </span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r moving-fit, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-moving-fit</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Generalized Extreme Value distribution parameters fit to running five-year windows of daily minimum temperature in Fort Collins, CO between 1902 and 2018"</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit GEVD using running five-year windows between 1902 and 2018 and store result</span></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a>mnt.yrs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1902</span><span class="sc">:</span><span class="dv">2018</span>){</span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>  mnt.yrs[[i<span class="dv">-1901</span>]] <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">format</span>(dt,<span class="st">"%Y"</span>) <span class="sc">==</span> <span class="fu">seq</span>(i<span class="dv">-2</span>,i<span class="sc">+</span><span class="dv">2</span>)), <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">5</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a>locs.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">locations =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">1</span>)))))</span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a>scls.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">scales =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>)))))</span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a>shps.yrs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">1902</span>,<span class="dv">2018</span>),<span class="at">shapes =</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(mnt.yrs,<span class="st">'[['</span>,<span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">3</span>)))))</span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>locs.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>locations)) <span class="sc">+</span> </span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Location, \u03bc"</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.64</span>) <span class="sc">+</span> </span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.8</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">41.48</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>scls.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>scales)) <span class="sc">+</span> </span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Scale, \u03c3"</span>) <span class="sc">+</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.26</span>) <span class="sc">+</span> </span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.15</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-153"><a href="#cb8-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">15.38</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-154"><a href="#cb8-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb8-155"><a href="#cb8-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb8-156"><a href="#cb8-156" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>shps.yrs, <span class="fu">aes</span>(<span class="at">x=</span>years, <span class="at">y=</span>shapes)) <span class="sc">+</span> </span>
<span id="cb8-157"><a href="#cb8-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Shape, \u03b3"</span>) <span class="sc">+</span></span>
<span id="cb8-158"><a href="#cb8-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.136</span>) <span class="sc">+</span> </span>
<span id="cb8-159"><a href="#cb8-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.143</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-160"><a href="#cb8-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fl">0.129</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb8-161"><a href="#cb8-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_nice</span>() <span class="sc">+</span> </span>
<span id="cb8-162"><a href="#cb8-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>))</span>
<span id="cb8-163"><a href="#cb8-163" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,p3,<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb8-164"><a href="#cb8-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-165"><a href="#cb8-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-166"><a href="#cb8-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-167"><a href="#cb8-167" aria-hidden="true" tabindex="-1"></a>The estimates show obvious variation in the location parameter over the examined years with the modal (negative) daily low slowly decreasing (increasing) over time. This is consistent with the increasing trend in daily minimum temperatures observed in @fig-global-plot. Compared to the location parameter, the other two parameters do not similarly vary over time. However, it's intuitively reasonable to expect seasonal variation in daily minimum temperatures, and a simply harmonic function can be used to model cyclical variation in seasonal lows. For the non-stationary case, I fit two candidate models: one modeling annual and seasonal variation in the location parameter and a second modeling additional seasonal variation in the scale parameter. In both models, the location parameter was modeled using: $$\mu=\mu_0+\mu_1cos(2\pi*doy/365.25)+\mu_2sin(2\pi*doy/365.25)+\mu_3*year$${#eq-fit-1} where $doy$ is the day of the year represented as an integer and $year$ is the calendar year. </span>
<span id="cb8-168"><a href="#cb8-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-169"><a href="#cb8-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit1-summary, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-170"><a href="#cb8-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fit1</span></span>
<span id="cb8-171"><a href="#cb8-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Parameter estimates for non-stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022"</span></span>
<span id="cb8-172"><a href="#cb8-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1</span></span>
<span id="cb8-173"><a href="#cb8-173" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx,<span class="at">location.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> Year, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb8-174"><a href="#cb8-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-175"><a href="#cb8-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1 summary table</span></span>
<span id="cb8-176"><a href="#cb8-176" aria-hidden="true" tabindex="-1"></a>fit1.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit1, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-177"><a href="#cb8-177" aria-hidden="true" tabindex="-1"></a>params.ci.fit1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit1, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb8-178"><a href="#cb8-178" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb8-179"><a href="#cb8-179" aria-hidden="true" tabindex="-1"></a>fit1.model.summary <span class="ot">&lt;-</span> params.ci.fit1 <span class="sc">|&gt;</span> </span>
<span id="cb8-180"><a href="#cb8-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit1<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-181"><a href="#cb8-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb8-182"><a href="#cb8-182" aria-hidden="true" tabindex="-1"></a>fit1.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"&amp;#956;0"</span>, <span class="st">"&amp;#956;1"</span>, <span class="st">"&amp;#956;2"</span>, <span class="st">"&amp;#956;3"</span>, <span class="st">"Scale, &amp;#963;"</span>,<span class="st">"Shape, &amp;#947;"</span>), fit1.model.summary)</span>
<span id="cb8-183"><a href="#cb8-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-184"><a href="#cb8-184" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit1.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-185"><a href="#cb8-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-186"><a href="#cb8-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-187"><a href="#cb8-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Location, &amp;#956;"</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-188"><a href="#cb8-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit1<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit1.summary<span class="sc">$</span>BIC,<span class="dv">2</span>),<span class="st">"; See Equation 3 for the function used to model the location  parameter."</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-189"><a href="#cb8-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-190"><a href="#cb8-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-191"><a href="#cb8-191" aria-hidden="true" tabindex="-1"></a>Compared to the stationary model, the BIC is about 18% lower for the non-stationary mode, indicating a much better fit when the annual and seasonal variation in the location parameter was modeled. In the second model, the scale parameter was additionally modeled using: $$\sigma=\sigma_0+\sigma_1cos(2\pi*doy/365.25)+\sigma_2sin(2\pi*doy/365.25)$${#eq-fit-2}</span>
<span id="cb8-192"><a href="#cb8-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-193"><a href="#cb8-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit2-summary, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-194"><a href="#cb8-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-fit2</span></span>
<span id="cb8-195"><a href="#cb8-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Parameter estimates for non-stationary Generalized Extreme Value distribution fit to negative daily minimum temperatures in Fort Collins, CO between 1900 and 2022"</span></span>
<span id="cb8-196"><a href="#cb8-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 2</span></span>
<span id="cb8-197"><a href="#cb8-197" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">fevd</span>(<span class="sc">-</span>MnT <span class="sc">~</span> <span class="dv">1</span>, FCwx,<span class="at">location.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> Year, <span class="at">scale.fun =</span> <span class="sc">~</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>) <span class="sc">+</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>doy<span class="sc">/</span><span class="fl">365.25</span>), <span class="at">use.phi =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"GEV"</span>, <span class="at">span =</span> <span class="dv">123</span>, <span class="at">units =</span> <span class="st">"deg F"</span>, <span class="at">time.units =</span> <span class="st">"days"</span>, <span class="at">period.basis =</span> <span class="st">"year"</span>)</span>
<span id="cb8-198"><a href="#cb8-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-199"><a href="#cb8-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-stationary model 1 summary table</span></span>
<span id="cb8-200"><a href="#cb8-200" aria-hidden="true" tabindex="-1"></a>fit2.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit2, <span class="at">silent=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-201"><a href="#cb8-201" aria-hidden="true" tabindex="-1"></a>params.ci.fit2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"parameter"</span>),<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb8-202"><a href="#cb8-202" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(params.ci.fit2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>)</span>
<span id="cb8-203"><a href="#cb8-203" aria-hidden="true" tabindex="-1"></a>fit2.model.summary <span class="ot">&lt;-</span> params.ci.fit2 <span class="sc">|&gt;</span> </span>
<span id="cb8-204"><a href="#cb8-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> <span class="fu">paste</span>(<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>est,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">" ("</span>,<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>ll,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">", "</span>,<span class="fu">round</span>(params.ci.fit2<span class="sc">$</span>ul,<span class="at">digits=</span><span class="dv">2</span>),<span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-205"><a href="#cb8-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate)</span>
<span id="cb8-206"><a href="#cb8-206" aria-hidden="true" tabindex="-1"></a>fit2.model.summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">params =</span> <span class="fu">c</span>(<span class="st">"&amp;#956;0"</span>, <span class="st">"&amp;#956;1"</span>, <span class="st">"&amp;#956;2"</span>, <span class="st">"&amp;#956;3"</span>, <span class="st">"&amp;#963;0"</span>, <span class="st">"&amp;#963;1"</span>, <span class="st">"&amp;#963;2"</span>, <span class="st">"Shape, &amp;#947;"</span>), fit2.model.summary)</span>
<span id="cb8-207"><a href="#cb8-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-208"><a href="#cb8-208" aria-hidden="true" tabindex="-1"></a><span class="fu">footnote</span>(<span class="fu">kbl</span>(fit2.model.summary, <span class="at">format=</span><span class="st">"html"</span>, <span class="at">booktabs=</span><span class="cn">TRUE</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Parameters"</span>, <span class="st">"Estimate (95% CI)"</span>), <span class="at">row.names=</span><span class="cn">FALSE</span>, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">align=</span><span class="st">"lc"</span>, <span class="at">escape=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-209"><a href="#cb8-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>,<span class="at">width=</span><span class="st">"10em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-210"><a href="#cb8-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>,<span class="at">width=</span><span class="st">"12em"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-211"><a href="#cb8-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Location, &amp;#956;"</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-212"><a href="#cb8-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Scale, &amp;#963;"</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-213"><a href="#cb8-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"left"</span>), <span class="fu">paste</span>(<span class="st">"Negative log-likelihood (NLLH): "</span>,<span class="fu">round</span>(fit2<span class="sc">$</span>results<span class="sc">$</span>value,<span class="dv">2</span>),<span class="st">"; Bayesian Information Criterion (BIC): "</span>,<span class="fu">round</span>(fit2.summary<span class="sc">$</span>BIC,<span class="dv">2</span>),<span class="st">"; See Equation 3 and Equation 4 for the functions used to model the location and scale parameter, respectively."</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">footnote_as_chunk =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-214"><a href="#cb8-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-215"><a href="#cb8-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-216"><a href="#cb8-216" aria-hidden="true" tabindex="-1"></a>The fit statistics and model diagnostics (not shown) generally suggest that the second model is a better choice between the two non-stationary candidate models. Although it could undoubtedly be improved, I want to explore some applications. With the fit model, you can calculate several things </span>
<span id="cb8-217"><a href="#cb8-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-218"><a href="#cb8-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r return-levels, echo=TRUE, warning=FALSE, error=FALSE}</span></span>
<span id="cb8-219"><a href="#cb8-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-return-levels</span></span>
<span id="cb8-220"><a href="#cb8-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Effective 100-year return levels for daily minimum temperatures in Fort Collins, CO on different dates"</span></span>
<span id="cb8-221"><a href="#cb8-221" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1900</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-222"><a href="#cb8-222" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1900 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v1),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-223"><a href="#cb8-223" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1900) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-224"><a href="#cb8-224" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1940</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-225"><a href="#cb8-225" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1940 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v2),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-226"><a href="#cb8-226" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1940) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-227"><a href="#cb8-227" aria-hidden="true" tabindex="-1"></a>v3 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1980</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-228"><a href="#cb8-228" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr1980 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v3),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-229"><a href="#cb8-229" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr1980) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-230"><a href="#cb8-230" aria-hidden="true" tabindex="-1"></a>v4 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2000</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-231"><a href="#cb8-231" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr2000 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v4),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-232"><a href="#cb8-232" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr2000) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-233"><a href="#cb8-233" aria-hidden="true" tabindex="-1"></a>v5 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2020</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">60</span><span class="sc">:</span><span class="dv">120</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-234"><a href="#cb8-234" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsMarApr2020 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v5),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-235"><a href="#cb8-235" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsMarApr2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-236"><a href="#cb8-236" aria-hidden="true" tabindex="-1"></a>v6 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1900</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-237"><a href="#cb8-237" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1900 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v6),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-238"><a href="#cb8-238" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1900) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-239"><a href="#cb8-239" aria-hidden="true" tabindex="-1"></a>v7 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1940</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-240"><a href="#cb8-240" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1940 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v7),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-241"><a href="#cb8-241" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1940) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-242"><a href="#cb8-242" aria-hidden="true" tabindex="-1"></a>v8 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">1980</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-243"><a href="#cb8-243" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov1980 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v8),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-244"><a href="#cb8-244" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov1980) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-245"><a href="#cb8-245" aria-hidden="true" tabindex="-1"></a>v9 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2000</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-246"><a href="#cb8-246" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov2000 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v9),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-247"><a href="#cb8-247" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov2000) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-248"><a href="#cb8-248" aria-hidden="true" tabindex="-1"></a>v10 <span class="ot">&lt;-</span> <span class="fu">make.qcov</span>(fit2, <span class="at">vals =</span> <span class="fu">list</span>(<span class="at">mu1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">mu3 =</span> <span class="fu">rep</span>(<span class="dv">2020</span>,<span class="dv">61</span>), <span class="at">phi1 =</span> <span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>), <span class="at">phi2 =</span> <span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span><span class="dv">274</span><span class="sc">:</span><span class="dv">334</span><span class="sc">/</span><span class="fl">365.25</span>)))</span>
<span id="cb8-249"><a href="#cb8-249" aria-hidden="true" tabindex="-1"></a>ci100YrRLevelsOctNov2020 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">ci</span>(fit2, <span class="at">type =</span> <span class="st">"return.level"</span>, <span class="at">return.period =</span> <span class="dv">100</span>, <span class="at">qcov =</span> v10),<span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb8-250"><a href="#cb8-250" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ci100YrRLevelsOctNov2020) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ll"</span>,<span class="st">"est"</span>,<span class="st">"ul"</span>,<span class="st">"se"</span>)</span>
<span id="cb8-251"><a href="#cb8-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-252"><a href="#cb8-252" aria-hidden="true" tabindex="-1"></a>ciRLevels <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ci100YrRLevelsMarApr1900,ci100YrRLevelsMarApr1940,ci100YrRLevelsMarApr1980,ci100YrRLevelsMarApr2000,ci100YrRLevelsMarApr2020,ci100YrRLevelsOctNov1900,ci100YrRLevelsOctNov1940,ci100YrRLevelsOctNov1980,ci100YrRLevelsOctNov2000,ci100YrRLevelsOctNov2020) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">rep</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="dv">1900</span>,<span class="dv">1940</span>,<span class="dv">1980</span>,<span class="dv">2000</span>,<span class="dv">2020</span>)),<span class="at">each=</span><span class="dv">61</span>,<span class="at">times=</span><span class="dv">2</span>), <span class="at">dt =</span> <span class="fu">rbind</span>(<span class="fu">data.frame</span>(<span class="at">dt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1900/03/01"</span>),<span class="fu">as.Date</span>(<span class="st">"1900/04/30"</span>),<span class="at">by=</span><span class="st">"days"</span>),<span class="dv">5</span>)),<span class="fu">data.frame</span>(<span class="at">dt =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"1900/10/01"</span>),<span class="fu">as.Date</span>(<span class="st">"1900/11/30"</span>),<span class="at">by=</span><span class="st">"days"</span>),<span class="dv">5</span>))), <span class="at">Season =</span> <span class="fu">rep</span>(<span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Spring"</span>,<span class="st">"Fall"</span>)),<span class="at">each=</span><span class="dv">305</span>))</span>
<span id="cb8-253"><a href="#cb8-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-254"><a href="#cb8-254" aria-hidden="true" tabindex="-1"></a>ciRLevels[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> ciRLevels[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb8-255"><a href="#cb8-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-256"><a href="#cb8-256" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ciRLevels, <span class="fu">aes</span>(<span class="at">x =</span> dt<span class="sc">$</span>dt, <span class="at">y =</span> est)) <span class="sc">+</span> </span>
<span id="cb8-257"><a href="#cb8-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> Year), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ll,<span class="at">ymax=</span>ul,<span class="at">fill=</span>Year),<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb8-258"><a href="#cb8-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"100-year daily low"</span>) <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span><span class="fu">factor</span>(Season, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Spring"</span>,<span class="st">"Fall"</span>)), <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb8-259"><a href="#cb8-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_nice</span>()</span>
<span id="cb8-260"><a href="#cb8-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-261"><a href="#cb8-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb8-262"><a href="#cb8-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-263"><a href="#cb8-263" aria-hidden="true" tabindex="-1"></a>Just last year, we had a 15<span class="dv">&amp;deg;</span> F daily low on 15 April 2021 - a 100-year freeze! </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2022 Daniel Burcham</div>   
      <div class="nav-footer-center"><span class="faux-block"><i class="fa-brands fa-orcid" aria-label="orcid"></i> <strong>ORCID</strong> <a href="https://orcid.org/0000-0002-1793-3945">0000-0002-1793-3945</a></span><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



</body></html>